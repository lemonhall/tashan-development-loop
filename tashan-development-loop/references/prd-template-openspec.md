# PRD / Spec 模板（OpenSpec 风格）

> 目的：把“要造什么/为什么/边界/约束/验收”写成**可审查、可追溯、可验证**的稳定口径。  
> PRD 是“设计图”，版本化计划（`docs/plan/vN-*`）是“施工计划”。两者必须能互相引用、互相校验。

## 0) 元信息

- Topic：
- Owner：
- Status：draft / review / approved
- Version：
- Last updated：
- Links：
  - 计划入口：`docs/plan/vN-index.md`
  - 决策记录（如有）：`docs/adr/...`

## 1) 背景与问题（Problem Statement）

- 当前痛点是什么？（可举 1–3 个真实例子）
- 为什么现在必须做？不做会怎样？
- 已有事实/约束（技术栈、平台、性能、测试门禁、数据口径等）

## 2) 目标（Goals）

用“可验收”的语言写目标：

- G1：
- G2：
- G3：

## 3) 非目标（Non-goals）

明确“不做什么/不承诺什么”（这是防返工的关键）：

- NG1：
- NG2：

## 4) 术语与口径（Glossary / Contracts）

把关键名词与数据口径写清楚，避免不同文档换名：

- Term A：定义…
- ID 口径：例如 `port_id` / `fleet_id` / `Req ID` 的格式、唯一性与稳定性要求

## 5) 用户画像与关键场景（Personas & Scenarios）

至少列出 3 个关键场景（从用户动作到系统结果）：

- S1：用户做什么 → 系统应当发生什么（含边界条件）
- S2：
- S3：

## 6) 需求清单（Requirements with Req IDs）

> 每条需求必须有 **Req ID**（例如 `REQ-001`），并提供可二元判定的验收口径与验证方式。

表格模板：

| Req ID | 需求描述 | 验收口径（可二元判定） | 验证方式（命令/测试/步骤） | 优先级 | 依赖/风险 |
|---|---|---|---|---|---|
| REQ-001 |  |  |  | P0/P1/P2 |  |

## 7) 约束与不接受（Constraints）

- 性能与规模（例如：数据量上限、复杂度上限、延迟预算）
- 可靠性与一致性（例如：确定性、可回归性、容错策略）
- 安全与权限（例如：可访问范围、默认拒绝策略）
- 平台兼容（例如：Windows/WSL、编辑器/导出）

## 8) 可观测性（可选）

- 要记录哪些事件/指标？用于什么决策或排障？
- 证据要落在哪里？（log / artifacts / tests）

## 9) 追溯矩阵（由实施侧维护，避免漂移）

> 目标：PRD、计划、测试、证据、代码之间必须能串起来。

| Req ID | vN 计划条目 | tests/commands | 证据（log/artifact） | 关键代码路径 |
|---|---|---|---|---|
| REQ-001 | vN-xx |  |  |  |

